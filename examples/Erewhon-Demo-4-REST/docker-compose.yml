version: "3.8"
services:
  jade-rap:
    image: ${Registry:-}/jade/database-server:${Tag:-20.0.01-x64-U}
    container_name: "jade-database-server"
    volumes:
      - ${DatabasePath:-c:\jade\system}:c:\system
      - ${JournalPath:-c:\jade\journals}:c:\journals
      - ${LogPath:-c:\jade\logs}:c:\logs
    ports:
      - "${RapListenPort:-9901}:9901"
    networks:
      - jade-net

  jade-erewhon-webshop:
    depends_on: 
      - jade-rap
    image: erewhon/webshop:v1
    container_name: "jade-erewhon-webshop"
    volumes:
      - ${ImagesPath:-c:\jade\images}:c:\temp
      - ${LogPath:-c:\jade\logs}:c:\logs
    ports:
      - "6107:6107"
    networks:
      - jade-net

  jade-erewhon-rest:
    depends_on: 
      - jade-rap
    image: erewhon/rest-api:v1
    container_name: "jade-erewhon-rest"
    volumes:
      - ${ImagesPath:-c:\jade\images}:c:\temp
      - ${LogPath:-c:\jade\logs}:c:\logs
    ports:
      - "6108:6108"
    networks:
      - jade-net
  
  jade-iis-server:
    image: erewhon/iis-server:v1
    container_name: "jade-iis-server"
    volumes:
      - ${ImagesPath:-c:\jade\images}:c:\temp
      - ${IISLogPath:-C:\jade\iis_logs}:C:\inetpub\logs\FailedReqLogFiles\W3SVC1
      - ${IISLogPath:-C:\jade\iis_logs}:C:\bin_jadehttp\logs
    networks:
      - jade-net

networks:
  jade-net:
    external:
      name: nat
